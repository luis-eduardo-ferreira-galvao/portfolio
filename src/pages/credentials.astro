---
import Layout from "../layouts/Layout.astro";
import CertificatesSlider, {
    type Certificate,
} from "../components/islands/CertificatesSlider";
import { getImage } from "astro:assets";

// Import all certificate images
const images = import.meta.glob<{ default: ImageMetadata }>(
    "../assets/images/*.{jpg,png,jpeg,webp}",
    { eager: true },
);

// Helper to find image by filename (loose match)
const findImage = (filename: string) => {
    const key = Object.keys(images).find((k) => k.includes(filename));
    return key ? images[key].default : undefined;
};

const rawCertificates: Certificate[] = [
    {
        id: 1,
        title: "Fortinet Certified Fundamentals in Cybersecurity (FCF)",
        issuer: "Fortinet",
        date: "2025",
        description:
            "Certified in Fortinet Fundamentals in Cybersecurity, showcasing expertise in the fundamentals of cybersecurity.",
        image: "fortinet-certified-fundamentals-in-cybersecurity.jpg",
        link: "#",
    },
    {
        id: 2,
        title: "Cyber Threat Management",
        issuer: "Cisco Systems",
        date: "2025",
        description:
            "Certified in Cisco Cyber Threat Management, showcasing expertise in the fundamentals of cybersecurity.",
        image: "cyber-threat-management.jpg",
        link: "#",
    },
    {
        id: 3,
        title: "Video Systems Camera Technical",
        issuer: "Bosch Security Systems",
        date: "2025",
        description:
            "Certified in Bosch Video Systems Camera Technical, showcasing expertise in IP video surveillance systems.",
        image: "video-camera-technical.jpg",
        link: "#",
    },
    {
        id: 4,
        title: "Public Address PRAESENSA Technical",
        issuer: "Bosch Security Systems",
        date: "2025",
        description:
            "Certified in Bosch Public Address PRAESENSA Technical, showcasing expertise in IP public address systems.",
        image: "public-address-praesensa-technical.jpg",
        link: "#",
    },
    {
        id: 5,
        title: "OMNEO Networking",
        issuer: "Bosch Security Systems",
        date: "2025",
        description:
            "Certified in Bosch OMNEO Networking, showcasing expertise in IP networking systems.",
        image: "omneo-networking.jpg",
        link: "#",
    },
    {
        id: 6,
        title: "Access Control & Biometrics",
        issuer: "Suprema Inc.",
        date: "2025",
        description:
            "Certified in Suprema Access Control & Biometrics, showcasing expertise in Physical Access Control Systems.",
        image: "controle-de-acesso-e-biometria-suprema.jpg",
        link: "#",
    },
    {
        id: 7,
        title: "Suprema Certified Integrator",
        issuer: "Suprema Inc.",
        date: "2025",
        description:
            "Certified in Suprema Integrator Professional Certification, showcasing expertise in Physical Access Control Systems.",
        image: "integrador-certificado-suprema.jpg",
        link: "#",
    },
    {
        id: 8,
        title: "Introduction to Linux (LFS101)",
        issuer: "Linux Foundation",
        date: "2025",
        description:
            "Certified in Introduction to Linux (LFS101), showcasing expertise in Linux operating systems.",
        image: "LFS101.jpg",
        link: "#",
    },
    {
        id: 9,
        title: "Oracle Certified Foundations Associate",
        issuer: "Oracle",
        date: "2025",
        description:
            "Certified in Oracle Certified Foundations Associate, showcasing expertise in Oracle databases.",
        image: "oracle-certified-foundations-associate.jpg",
        link: "#",
    },
    {
        id: 10,
        title: "Physical Network Topologies",
        issuer: "Axis Communications",
        date: "2025",
        description:
            "Certified in Physical Network Topologies, showcasing expertise in network topologies.",
        image: "physical-network-topologies.jpg",
        link: "#",
    },
    {
        id: 11,
        title: "AXIS Site Designer",
        issuer: "Axis Communications",
        date: "2025",
        description:
            "Certified in Axis Site Designer, showcasing expertise in Axis camera systems.",
        image: "axis-site-designer.jpg",
        link: "#",
    },
    {
        id: 12,
        title: "SP3801 - Installing Premises Cabling Systems ACT I",
        issuer: "CommScope",
        date: "2022",
        description:
            "Certified in SP3801 - Installing Premises Cabling Systems ACT I, showcasing expertise in Premises Cabling Systems.",
        image: "SP3801.jpg",
        link: "#",
    },
    {
        id: 13,
        title: "SP3802 - Certifying and Troubleshooting Premises Cabling Systems ACT II",
        issuer: "CommScope",
        date: "2022",
        description:
            "Certified in SP3802 - Certifying and Troubleshooting Premises Cabling Systems ACT II, showcasing expertise in Premises Cabling Systems.",
        image: "SP3802.jpg",
        link: "#",
    },
    {
        id: 14,
        title: "Technical SEO: Hosting and Server Configuration",
        issuer: "Yoast Academy",
        date: "2025",
        description:
            "Certified in Technical SEO: Hosting and Server Configuration, showcasing expertise in SEO.",
        image: "technical-seo-hosting-and-server-configuration.jpg",
        link: "#",
    },
];

const certificates = await Promise.all(
    rawCertificates.map(async (cert) => {
        if (cert.image) {
            const img = findImage(cert.image);
            if (img) {
                const optimized = await getImage({
                    src: img,
                    format: "webp",
                    width: 600,
                });
                return { ...cert, image: optimized.src };
            }
        }
        return cert;
    }),
);

const base = import.meta.env.BASE_URL.replace(/\/$/, "");
---

<Layout
    title="Credentials | Engineering & Code"
    description="Verified excellence through certifications."
>
    <!-- Full width container for the immersive slider -->
    <div class="w-full min-h-screen flex items-center bg-[#0d0d0d]">
        <div class="container mx-auto px-4">
            <CertificatesSlider
                client:only="react"
                certificates={certificates}
            />
        </div>
    </div>
</Layout>
