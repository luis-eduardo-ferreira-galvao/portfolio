---
import { getCollection } from "astro:content";
import Layout from "../../layouts/Layout.astro";

export async function getStaticPaths() {
	const projects = await getCollection("projects");
	return projects.map((project) => ({
		params: { slug: project.slug },
		props: { project },
	}));
}

const { project } = Astro.props;
const { Content } = await project.render();

const dateStr = project.data.date.toLocaleDateString("en-US", {
	year: "numeric",
	month: "long",
	day: "numeric",
});
---

<Layout
	title={`${project.data.title} | Case Study`}
	description={project.data.description}
>
	<div class="max-w-3xl mx-auto">
		<a
			href={`${import.meta.env.BASE_URL}/projects`}
			class="inline-flex items-center text-sm text-slate-400 hover:text-white mb-6 transition-colors"
		>
			← Back to Projects
		</a>

		<header class="mb-10">
			<div class="flex gap-2 mb-4">
				{
					project.data.tags.map((tag) => (
						<span class="text-xs font-mono px-2 py-1 bg-blue-500/10 text-blue-400 rounded">
							{tag}
						</span>
					))
				}
			</div>

			<h1
				class="text-4xl md:text-5xl font-bold text-white mb-4 leading-tight"
			>
				{project.data.title}
			</h1>
			<div class="flex items-center gap-4 text-slate-400 text-sm">
				<time datetime={project.data.date.toISOString()}>{dateStr}</time
				>
				<span>•</span>
				<span>{project.data.description}</span>
			</div>

			{
				(project.data.githubUrl || project.data.liveUrl) && (
					<div class="flex gap-4 mt-6">
						{project.data.githubUrl && (
							<a
								href={project.data.githubUrl}
								target="_blank"
								class="text-white bg-slate-800 hover:bg-slate-700 px-4 py-2 rounded-lg text-sm font-medium transition-colors"
							>
								View code on GitHub
							</a>
						)}
					</div>
				)
			}
		</header>

		<div
			class="prose prose-invert prose-lg max-w-none prose-p:mt-0 prose-p:mb-5 prose-headings:text-white prose-a:text-blue-400"
		>
			<Content />
		</div>
	</div>
</Layout>
